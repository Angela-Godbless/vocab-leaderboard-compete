<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ‹ä¸­å–®å­—æ’è¡Œæ¦œæŒ‘æˆ°è³½ - L1åˆ°L6å®Œæ•´ç‰ˆ</title>
    <link rel="stylesheet" href="leaderboard.css"> 
    <style>
        /* é€™è£¡æ”¾è‘—æ‚¨åŸæœ¬çš„éŠæˆ²æ¨£å¼ï¼Œæˆ‘ç‚ºæ‚¨ä¿ç•™äº†ä¸‹ä¾† */
        :root {
            --primary-color: #4CAF50;
            --wrong-color: #f44336;
            --timer-color: #FF9800;
            --bg-level-1: #E3F2FD; /* æ·ºè— */
            --bg-level-2: #E8F5E9; /* æ·ºç¶  */
            --bg-level-3: #FFF3E0; /* æ·ºæ©˜ */
            --bg-level-4: #F3E5F5; /* æ·ºç´« */
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-level-1);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            transition: background-color 0.5s ease;
            user-select: none;
        }

        .container {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            width: 90%;
            max-width: 500px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        h1 { color: #333; margin: 10px 0; font-size: 1.8rem; }

        .info-panel {
            display: flex;
            justify-content: space-between;
            background: #f0f0f0;
            padding: 10px 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            font-weight: bold;
            color: #333;
            font-size: 0.9rem;
        }

        .score-box, .high-score-box {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .big-num { font-size: 1.2rem; color: #2196F3; }
        .high-score-num { color: #FF9800; }

        .timer-container {
            width: 100%;
            height: 8px;
            background: #ddd;
            border-radius: 4px;
            margin-bottom: 15px;
            overflow: hidden;
            position: relative;
        }

        .timer-bar {
            height: 100%;
            width: 100%;
            background: var(--timer-color);
            transition: width 0.1s linear;
        }

        .word-display {
            font-size: 2.8rem;
            font-weight: 800;
            color: #2c3e50;
            margin: 20px 0;
            min-height: 60px;
        }

        input[type="text"] {
            width: 80%;
            padding: 15px;
            font-size: 1.3rem;
            border: 3px solid #ddd;
            border-radius: 12px;
            outline: none;
            text-align: center;
            font-weight: bold;
        }

        input[type="text"]:focus { border-color: var(--primary-color); }

        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 15px;
            font-size: 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            margin-top: 20px;
            width: 100%;
            font-weight: bold;
            box-shadow: 0 4px 0 #388E3C; 
            transition: transform 0.1s;
        }

        .btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        .feedback {
            margin-top: 15px;
            font-size: 1.1rem;
            min-height: 1.5em;
            font-weight: bold;
        }

        .combo-badge {
            display: inline-block;
            background: #FF5722;
            color: white;
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-left: 5px;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.3s;
        }
        
        .combo-active { opacity: 1; transform: scale(1); }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }
        .shake-anim { animation: shake 0.4s ease-in-out; }

        /* æ’è¡Œæ¦œå½ˆçª—æ¨£å¼ */
        .modal {
            display: none; 
            position: fixed;
            z-index: 10; 
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4); 
            padding-top: 60px;
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border-radius: 15px;
            width: 80%;
            max-width: 450px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            text-align: left;
        }

        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }

        #upload-score-btn {
            background-color: #FF9800; 
            box-shadow: 0 4px 0 #F57C00;
        }

    </style>
</head>
<body>

<div class="container">
    <div class="info-panel">
        <div class="score-box">
            <span>å¾—åˆ†</span>
            <span class="big-num" id="score">0</span>
        </div>
        <div class="score-box">
            <span>Level</span>
            <span class="big-num" id="level-num">1</span>
        </div>
        <div class="high-score-box">
            <span>ğŸ‘‘ æœ¬æ©Ÿæœ€é«˜</span>
            <span class="big-num high-score-num" id="high-score">0</span>
        </div>
    </div>

    <div class="timer-container">
        <div class="timer-bar" id="timer-bar"></div>
    </div>

    <div class="word-display" id="question-word">Press Start</div>
    
    <div style="height: 20px;">
        <span id="combo-display" class="combo-badge">Combo x2!</span>
    </div>

    <input type="text" id="answer-input" placeholder="è¼¸å…¥è‹±æ–‡..." autocomplete="off" disabled>
    
    <button class="btn" id="submit-btn" onclick="startGame()">é–‹å§‹æŒ‘æˆ°</button>
    <button class="btn" id="leaderboard-btn" style="background-color: #2196F3; box-shadow: 0 4px 0 #1976D2; margin-top: 10px;" onclick="openLeaderboard()">æŸ¥çœ‹å…¨çƒæ’è¡Œæ¦œ</button>

    <div class="feedback" id="feedback-msg"></div>
</div>

<div id="leaderboard-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeLeaderboard()">&times;</span>
        <h2>ğŸ† å…¨çƒå–®å­—æŒ‘æˆ°æ’è¡Œæ¦œ</h2>
        <table id="leaderboard-table">
            <thead>
                <tr><th>#</th><th>å§“å</th><th>åˆ†æ•¸</th><th>æ—¥æœŸ</th></tr>
            </thead>
            <tbody>
                </tbody>
        </table>
        <p style="margin-top: 15px; text-align: center;">
            <span id="modal-current-score" style="font-weight: bold; color: #FF9800;"></span>
        </p>
        <button class="btn" id="upload-score-btn" onclick="guideScoreUpload()">
            ä¸Šå‚³æˆ‘çš„åˆ†æ•¸ (äººå·¥å¡«è¡¨å–®)
        </button>
    </div>
</div>


<script>
    // --- åœ‹ä¸­è‹±èª(ä¸‰)å–®å­—åº« (L1-L6) å…± 145 å€‹å–®å­— ---
    const vocabularyList = [
        // L1: Dialogue, Word Power, Reading
        { ch: "æ˜¨å¤©", en: "yesterday" }, { ch: "ç ”è®€", en: "studies" }, { ch: "æ…¢è·‘", en: "jogging" },
        { ch: "è§€çœ‹", en: "watches" }, { ch: "ä¸Šæ¬¡çš„", en: "last" }, { ch: "æ­»äº¡", en: "death" },
        { ch: "ä¸€äº›ã€å°‘è¨±", en: "a few" }, { ch: "ä»¥å‰", en: "ago" }, { ch: "çˆ¶æ¯", en: "parents" },
        { ch: "æ˜¯ (éå»å¼è¤‡æ•¸)", en: "were" }, { ch: "æ˜¯ (éå»å¼å–®æ•¸)", en: "was" }, { ch: "å¿…é ˆ", en: "must" },
        { ch: "éä¸–", en: "passed away" }, { ch: "ä¸€èµ·", en: "together" }, { ch: "è²¼å¿ƒçš„ã€ç”œç¾çš„", en: "sweet" },
        { ch: "ä½¿...æƒ³èµ·", en: "remind; of" }, { ch: "å›æ†¶", en: "memory" }, { ch: "æ‰“æ‰®", en: "dressing up" },
        { ch: "éŸ³æ¨‚", en: "music" }, { ch: "åœ“åœˆ", en: "circle" }, { ch: "ç¨®æ¤", en: "planted" },
        { ch: "èŠ±æœµ", en: "flowers" }, { ch: "è Ÿç‡­", en: "candles" }, { ch: "å¢³å¢“", en: "tombs" },
        { ch: "è¨˜å¾—", en: "remember" }, { ch: "æ­»æ‰çš„", en: "dead" }, { ch: "è¦ªæˆš", en: "relatives" },
        { ch: "é¬¼é­‚", en: "ghost" }, { ch: "æ™šé»ã€ä¹‹å¾Œ", en: "later" }, { ch: "ç³–æœ", en: "candy" },
        { ch: "é¤é»", en: "meals" }, { ch: "åˆ†äº«", en: "share" }, { ch: "æ•…äº‹", en: "story" },
        { ch: "æ‰“æƒ", en: "sweeping" }, { ch: "æœ‰æ´»åŠ›çš„", en: "lively" }, { ch: "æ„Ÿäººçš„", en: "touching" },
        { ch: "ææ‡¼", en: "fear" },
        // L2: Dialogue, Word Power, Reading
        { ch: "æ•¸å­¸", en: "math" }, { ch: "è€ƒè©¦", en: "tests" }, { ch: "çŒœ", en: "Guess" },
        { ch: "å—¯ã€é€™å€‹å˜›", en: "Well" }, { ch: "çµå©š", en: "got married" }, { ch: "ç‚ºä»€éº¼", en: "Why" },
        { ch: "è³£", en: "sell" }, { ch: "å› ç‚º", en: "because" }, { ch: "è²§çª®çš„", en: "poor" },
        { ch: "ç™¼ç”Ÿ", en: "happened" }, { ch: "æ‰“åˆ°", en: "hit" }, { ch: "ç³Ÿç³•çš„", en: "terrible" },
        { ch: "æ›¾ç¶“", en: "ever" }, { ch: "å®Œæˆ", en: "finishes" }, { ch: "å†ä¹Ÿä¸", en: "not; anymore" },
        { ch: "å¥½å¥‡çš„", en: "curious" }, { ch: "çµå±€", en: "ending" }, { ch: "é‹å­", en: "shoes" },
        { ch: "è²·", en: "buy" }, { ch: "ä¸€é›™", en: "pair" }, { ch: "æ¡æ‘˜", en: "picked" },
        { ch: "å·§å…‹åŠ›", en: "Chocolate" }, { ch: "æ‰“ç ´", en: "break" }, { ch: "æ‰‹è‡‚ã€æ‡·æŠ±", en: "arms" },
        { ch: "é›»è…¦", en: "computer" }, { ch: "é¸æ“‡", en: "choose" }, { ch: "å°å­©", en: "children" },
        { ch: "å¹´ç´€", en: "age" }, { ch: "æ²’æœ‰", en: "without" }, { ch: "å¬°å…’", en: "baby" },
        { ch: "è®Šæˆ", en: "became" }, { ch: "å“­äº†", en: "cried" }, { ch: "æ²’æœ‰äºº", en: "Nobody" },
        { ch: "å®³æ€•çš„", en: "scared" }, { ch: "æ¡å–è¡Œå‹•", en: "take action" }, { ch: "å©šå§»", en: "marriage" },
        // L3: Reading, Word Power
        { ch: "åœ‹ç‹", en: "king" }, { ch: "é“è·¯", en: "way" }, { ch: "æ¿•çš„", en: "wet" },
        { ch: "æ³¥åœŸ", en: "mud" }, { ch: "æ·±çš„", en: "deep" }, { ch: "åœ¨...æ—é‚Š", en: "beside" },
        { ch: "åœ¨...ä¹‹å‰", en: "before" }, { ch: "å›°é›£çš„", en: "difficult" }, { ch: "è´è¶", en: "butterflies" },
        { ch: "å¤§ç¬‘", en: "laughing" }, { ch: "å¯èƒ½çš„", en: "possible" }, { ch: "ç¶“é", en: "passed by" },
        { ch: "æ”€çˆ¬", en: "climbing" }, { ch: "åº•éƒ¨", en: "bottom" }, { ch: "æ­»äº¡", en: "die" },
        { ch: "ç–²å€¦çš„", en: "tired" }, { ch: "çµ‚æ–¼", en: "finally" }, { ch: "æŠµé”", en: "arrive" },
        { ch: "é©šè¨çš„", en: "surprised" }, { ch: "è›‡", en: "snake" }, { ch: "æ‰“å­—", en: "type" },
        { ch: "æ‰‹æ©Ÿ", en: "cellphone" }, { ch: "è½è¦‹", en: "hear" }, { ch: "èŸ¾èœ", en: "toad" },
        { ch: "çªç„¶åœ°", en: "suddenly" }, { ch: "æ´", en: "hole" }, { ch: "ç„¡åŠ©çš„", en: "helpless" },
        { ch: "è¨Šæ¯", en: "message" }, { ch: "è¾çš„", en: "deaf" }, { ch: "è™è ", en: "bats" },
        { ch: "ç‹ç‹¸", en: "foxes" }, { ch: "è€é¼ ", en: "rat" }, { ch: "æ¯é›", en: "hens" },
        // L4: Dialogue, Word Power, Reading
        { ch: "è¡¨å…„å¼Ÿå§å¦¹", en: "cousins" }, { ch: "å·¥ä½œ", en: "job" }, { ch: "ä½œç‚º", en: "as" },
        { ch: "ç”·æœå‹™ç”Ÿ", en: "waiter" }, { ch: "å±…ä½", en: "live" }, { ch: "ç¶“é©—", en: "experience" },
        { ch: "ç©ºæ°£", en: "air" }, { ch: "æ–°é®®çš„", en: "fresh" }, { ch: "æµ·é¾œ", en: "sea turtle" },
        { ch: "æµ·ç˜", en: "beach" }, { ch: "æƒ³è¦", en: "want" }, { ch: "æ‡‰è©²", en: "should" },
        { ch: "æº–å‚™", en: "prepares" }, { ch: "æŒçºŒ", en: "kept" }, { ch: "ç·´ç¿’", en: "practices" },
        { ch: "é‡è¦çš„", en: "important" }, { ch: "å­¸ç¿’", en: "learned" }, { ch: "ä»¤äººé©šè¨çš„", en: "amazing" },
        { ch: "çŠç‘šç¤", en: "coral reefs" }, { ch: "è¾²å ´", en: "farm" }, { ch: "å·¥äºº", en: "worker" },
        { ch: "å¥³æœå‹™ç”Ÿ", en: "waitress" }, { ch: "å·¥å» ", en: "factories" }, { ch: "æ¨éŠ·å“¡", en: "salesman" },
        { ch: "æ¼å¤«", en: "fisherman" }, { ch: "å‹å–„çš„", en: "friendly" }, { ch: "ç”Ÿé•·", en: "grow" },
        { ch: "ç†è§£", en: "understand" }, { ch: "é›¢é–‹", en: "leave" }, { ch: "è¡æµª", en: "surfing" },
        { ch: "ç©å¸†èˆ¹", en: "sailing" }, { ch: "éœ²ç‡Ÿ", en: "camped" }, { ch: "é–‹å§‹", en: "begins" },
        { ch: "çµæŸ", en: "ended" }, { ch: "å¸Œæœ›", en: "hope" }, { ch: "ä¸å¿«æ¨‚çš„", en: "unhappy" },
        { ch: "æ–‡åŒ–", en: "culture" }, { ch: "é€²æ­¥", en: "progress" }, { ch: "å£éŸ³", en: "accent" },
        // L5: Dialogue, Word Power, Reading
        { ch: "ç…§ç‰‡", en: "photos" }, { ch: "ç•¶ç„¶", en: "Of course" }, { ch: "èŠ±è²» (éå»å¼)", en: "cost" },
        { ch: "ç¾å…ƒã€å…ƒ", en: "dollars" }, { ch: "å¯„é€ (éå»å¼)", en: "sent" }, { ch: "åŒ…è£¹", en: "package" },
        { ch: "ä»˜è²» (éå»å¼)", en: "paid" }, { ch: "åƒ¹æ ¼", en: "prices" }, { ch: "ä½çš„", en: "low" },
        { ch: "èŠ±è²» (æ™‚é–“/é‡‘éŒ¢)", en: "spend" }, { ch: "åˆ† (éŒ¢å¹£å–®ä½)", en: "cents" }, { ch: "ä¾¿å®œçš„", en: "cheap" },
        { ch: "æ“”å¿ƒ", en: "worry" }, { ch: "é›¨å‚˜", en: "umbrella" }, { ch: "æ–¹ä¾¿çš„", en: "convenient" },
        { ch: "é™é çš„", en: "far" }, { ch: "å»æ‰€", en: "restroom" }, { ch: "åŸé®", en: "town" },
        { ch: "ä¾¿åˆ©å•†åº—", en: "convenience store" }, { ch: "åˆ—å° (éå»å¼)", en: "printed" }, { ch: "åœç•™", en: "stay" },
        { ch: "ç™¾è²¨å…¬å¸", en: "department store" }, { ch: "ç¥ˆç¦±", en: "prays" }, { ch: "å¯ºå»Ÿ", en: "Temple" },
        { ch: "å¤–åœ‹äºº", en: "foreigners" }, { ch: "æƒ³åˆ°", en: "think of" }, { ch: "éŠå®¢", en: "visitors" },
        { ch: "å¤–åœ‹çš„", en: "foreign" }, { ch: "æŠµé” (éå»å¼)", en: "reached" }, { ch: "æ˜‚è²´çš„", en: "expensive" },
        { ch: "åŸå¸‚", en: "city" }, { ch: "èˆ’æœçš„", en: "comfortable" }, { ch: "ä¸€é»é»", en: "little" },
        { ch: "å¤§éƒ¨åˆ†çš„", en: "Most" }, { ch: "æŸäºº", en: "Someone" }, { ch: "å¹«æˆ‘ä¸€ä¸‹", en: "lend me a hand" },
        { ch: "å¯Œæœ‰çš„ã€è±å¯Œçš„", en: "rich" }, { ch: "ä»¥...ç‚ºæ¦®", en: "are; proud of" }, { ch: "ç„¡å°¾ç†Š", en: "koala" },
        { ch: "æ™¯è‰²", en: "scenery" }, { ch: "æ—…è¡Œ", en: "traveling" }, { ch: "ä»»ä½•åœ°æ–¹", en: "anywhere" },
        { ch: "æ­¤å¤–", en: "Besides" },
        // L6: Dialogue, Word Power, Reading
        { ch: "ç°¡å–®çš„", en: "simple" }, { ch: "ç¶²è·¯", en: "Internet" }, { ch: "å®ƒè‡ªå·±", en: "itself" },
        { ch: "å¯¦éš›ä¸Š", en: "actually" }, { ch: "å¤¢æƒ³", en: "dream" }, { ch: "è‡ªå·±çš„", en: "own" },
        { ch: "æ­Œæ‰‹çš„", en: "singerâ€™s" }, { ch: "æœªä¾†", en: "future" }, { ch: "æœ‰è¶£çš„", en: "interesting" },
        { ch: "å¯¦ç¾", en: "come true" }, { ch: "ä»Šæ™š", en: "tonight" }, { ch: "å”å”ã€èˆ…èˆ…", en: "uncle" },
        { ch: "æŠ«è–©", en: "pizza" }, { ch: "æ¼¢å ¡", en: "hamburgers" }, { ch: "æ™šé¤", en: "dinner" },
        { ch: "è£½é€ ", en: "creates" }, { ch: "æ­Œè©", en: "lyrics" }, { ch: "æ—‹å¾‹", en: "melody" },
        { ch: "è™›æ“¬çš„", en: "virtual" }, { ch: "æ•¸ä½çš„", en: "digital" }, { ch: "ç‡ˆ", en: "lamp" },
        { ch: "å‰ä»–", en: "guitar" }, { ch: "å°æç´", en: "Violins" }, { ch: "èœ‚èœœ", en: "honey" },
        { ch: "æ²™ç™¼", en: "couch" }, { ch: "å…¬å¯“", en: "apartment" }, { ch: "åŸå ¡", en: "castle" },
        { ch: "åœ°éœ‡", en: "earthquake" }, { ch: "é¢±é¢¨", en: "typhoons" }, { ch: "å‡ºç”Ÿ", en: "born" },
        { ch: "æˆåŠŸçš„", en: "successful" }, { ch: "å¤±æ•—", en: "failed" }, { ch: "è¨‚å–®", en: "order" },
        { ch: "é ˜å°è€…", en: "leader" }, { ch: "å¿ƒè‡Ÿ", en: "heart" }, { ch: "å¿˜è¨˜", en: "forgets" },
        { ch: "æ•™è¨“", en: "lessons" }, { ch: "æƒ…æ³ã€æ¡ˆä¾‹", en: "case" }, { ch: "å°å¿ƒçš„", en: "careful" },
        { ch: "ç¾ä»£çš„", en: "modern" }, { ch: "é–‹è»Š", en: "drive" }, { ch: "ä»–å€‘è‡ªå·±", en: "themselves" },
        { ch: "å¡‘é€ ã€å½¢ç‹€", en: "shape" }, { ch: "ç§‘æŠ€", en: "technology" }, { ch: "å¤§å­¸", en: "college" },
        { ch: "å…¬å¸", en: "company" }, { ch: "å®Œæˆ", en: "complete" }
    ];

    // --- éŠæˆ²é‚è¼¯ ---
    let currentLevel = 1;
    let score = 0;
    let highScore = localStorage.getItem('vocabGameHighScore') || 0;
    let currentWordObj = null;
    let combo = 0;
    let isGameRunning = false;
    let timerInterval;
    const timePerQuestion = 15;
    let timeLeft = timePerQuestion;

    const inputEl = document.getElementById('answer-input');
    const btnEl = document.getElementById('submit-btn');

    // ... (å…¶ä»– DOM å…ƒç´ ç²å–å’Œäº‹ä»¶ç›£è½ä¿ç•™)

    inputEl.addEventListener('keypress', function (e) {
        if (e.key === 'Enter' && isGameRunning) {
            checkAnswer();
        }
    });

    function startGame() {
        // ... (startGame å‡½æ•¸ä¿ç•™)
        isGameRunning = true;
        score = 0;
        currentLevel = 1;
        combo = 0;
        updateUI();
        inputEl.disabled = false;
        btnEl.onclick = checkAnswer;
        btnEl.textContent = "é€å‡º";
        document.body.style.backgroundColor = 'var(--bg-level-1)';
        nextQuestion();
    }

    function handleTimeOut() {
        // ... (handleTimeOut å‡½æ•¸ä¿ç•™)
        clearInterval(timerInterval);
        combo = 0;
        document.getElementById('feedback-msg').innerHTML = `â° æ™‚é–“åˆ°ï¼ç­”æ¡ˆæ˜¯: ${currentWordObj.en}`;
        document.getElementById('feedback-msg').style.color = "red";
        
        btnEl.textContent = "ä¸‹ä¸€é¡Œ (æŒ‰ Enter)";
        btnEl.onclick = nextQuestion;

        // éŠæˆ²çµæŸæ™‚æ‰“é–‹æ’è¡Œæ¦œ
        openLeaderboard(true); 
    }

    // ... (checkAnswer, handleCorrect, handleWrong, checkLevelUp, updateUI å‡½æ•¸ä¿ç•™)
    
    // --- æ’è¡Œæ¦œé‚è¼¯ ---

    const LEADERBOARD_URL = './leaderboard.json'; 

    function openLeaderboard(showCurrentScore = false) {
        const modal = document.getElementById('leaderboard-modal');
        modal.style.display = 'block';

        if (showCurrentScore) {
            document.getElementById('modal-current-score').textContent = `æœ¬æ¬¡å¾—åˆ†: ${score}`;
        } else {
            document.getElementById('modal-current-score').textContent = '';
        }

        fetchLeaderboard();
    }

    function closeLeaderboard() {
        document.getElementById('leaderboard-modal').style.display = 'none';
    }

    async function fetchLeaderboard() {
        const tableBody = document.querySelector('#leaderboard-table tbody');
        tableBody.innerHTML = '<tr><td colspan="4">è¼‰å…¥æ’è¡Œæ¦œä¸­...</td></tr>';

        try {
            const response = await fetch(LEADERBOARD_URL + '?t=' + new Date().getTime()); // æ·»åŠ æ™‚é–“æˆ³é¿å…å¿«å–
            if (!response.ok) {
                throw new Error('ç„¡æ³•è¼‰å…¥æ’è¡Œæ¦œæª”æ¡ˆã€‚');
            }
            const data = await response.json();
            displayLeaderboard(data);
        } catch (error) {
            console.error('Leaderboard fetch error:', error);
            tableBody.innerHTML = '<tr><td colspan="4" style="color: red;">âŒ ç„¡æ³•è¼‰å…¥æ’è¡Œæ¦œæ•¸æ“šã€‚</td></tr>';
        }
    }

    function displayLeaderboard(data) {
        const tableBody = document.querySelector('#leaderboard-table tbody');
        
        // æ’åºï¼šåˆ†æ•¸æœ€é«˜åœ¨å‰
        data.sort((a, b) => b.score - a.score);

        tableBody.innerHTML = ''; 
        if (data.length === 0) {
            tableBody.innerHTML = '<tr><td colspan="4">ç›®å‰é‚„æ²’æœ‰äººä¸Šæ¦œå–”ï¼</td></tr>';
            return;
        }

        data.slice(0, 10).forEach((entry, index) => { // é¡¯ç¤ºå‰ 10 å
            const row = tableBody.insertRow();
            row.innerHTML = `
                <td>${index + 1}</td>
                <td>${entry.name}</td>
                <td>${entry.score}</td>
                <td>${entry.date || 'æœªçŸ¥'}</td>
            `;
            // é«˜äº®å‰ä¸‰å
            if (index < 3) {
                row.style.fontWeight = 'bold';
                row.style.color = (index === 0) ? '#FFD700' : (index === 1 ? '#C0C0C0' : '#CD7F32');
            }
        });
    }

    function guideScoreUpload() {
        // è«‹å°‡ä¸‹æ–¹çš„ç¶²å€æ›¿æ›ç‚ºæ‚¨å»ºç«‹çš„ Google è¡¨å–®ç¶²å€
       const uploadFormUrl = "https://docs.google.com/forms/d/e/1FAIpQLS...";

        if (score === 0) {
            alert("æ‚¨æœ¬æ¬¡å¾—åˆ†ç‚º 0 åˆ†ï¼Œè«‹å…ˆæŒ‘æˆ°ï¼");
            return;
        }

        const message = `æ‚¨æœ¬æ¬¡å¾—åˆ†ç‚º ${score} åˆ†ï¼\n\nè«‹è¤‡è£½åˆ†æ•¸ï¼Œé»æ“Šã€Œç¢ºå®šã€å‰å¾€ Google è¡¨å–®ä¸Šå‚³æ‚¨çš„å§“åèˆ‡åˆ†æ•¸ã€‚`;
        
        // å˜—è©¦è¤‡è£½åˆ†æ•¸åˆ°å‰ªè²¼ç°¿ (è®“å­¸ç”Ÿæ–¹ä¾¿è²¼ä¸Š)
        navigator.clipboard.writeText(score).then(() => {
            alert(`${message}\n\n[åˆ†æ•¸å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿]`);
        }).catch(() => {
            alert(message);
        });

        if (uploadFormUrl && uploadFormUrl !== "è«‹è€å¸«/ç®¡ç†è€…åœ¨é€™è£¡å¡«å…¥ Google Form æˆ–å…¶ä»–è¡¨å–®ç¶²å€") {
             window.open(uploadFormUrl, '_blank');
        } else {
             alert("è«‹è€å¸«å…ˆè¨­å®šè¡¨å–®ç¶²å€ï¼");
        }
    }

</script>

</body>

</html>
